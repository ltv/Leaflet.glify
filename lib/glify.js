!function(t){function e(e){for(var r,s,o=e[0],g=e[1],l=e[2],c=0,u=[];c<o.length;c++)s=o[c],n[s]&&u.push(n[s][0]),n[s]=0;for(r in g)Object.prototype.hasOwnProperty.call(g,r)&&(t[r]=g[r]);for(h&&h(e);u.length;)u.shift()();return a.push.apply(a,l||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],r=!0,o=1;o<i.length;o++){var g=i[o];0!==n[g]&&(r=!1)}r&&(a.splice(e--,1),t=s(s.s=i[0]))}return t}var r={},n={1:0},a=[];function s(e){if(r[e])return r[e].exports;var i=r[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=r,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(i,r,function(e){return t[e]}.bind(null,r));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var o=window.webpackJsonp=window.webpackJsonp||[],g=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var h=g;a.push([9,0,2]),i()}([,function(t,e){t.exports=function(){var t=new Float32Array(16);return t._set=t.set,t.set=function(){return t._set.apply(this,arguments),this},t.translateMatrix=function(t,e){return this[12]+=this[0]*t+this[4]*e,this[13]+=this[1]*t+this[5]*e,this[14]+=this[2]*t+this[6]*e,this[15]+=this[3]*t+this[7]*e,this},t.scaleMatrix=function(t){return this[0]*=t,this[1]*=t,this[2]*=t,this[3]*=t,this[4]*=t,this[5]*=t,this[6]*=t,this[7]*=t,this},t}},,function(t,e){t.exports={defaults:function(t,e){var i,r={};for(i in e)e.hasOwnProperty(i)&&(r[i]=t.hasOwnProperty(i)?t[i]:e[i]);return r},tryFunction:function(t,e){return"function"==typeof t?t:void 0!==e&&e.hasOwnProperty(t)?e[t]:null},glslMin:function(t){return'"'+t.replace(/\r/g,"").replace(/[\/][\/].*\n/g,"").replace(/\n/g,"").replace(/\t+/g," ").replace(/\s\s+|\t/g," ")+'"'},pointInCircle:function(t,e,i){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)<=i*i},flattenData:function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var a=0;a<t[n].length;a++)for(var s=0;s<e;s++)i.vertices.push(t[n][a][s]);n>0&&(r+=t[n-1].length,i.holes.push(r))}return i},latLonToPixel:function(t,e){var i=Math.PI/180,r=4*Math.PI,n=Math.sin(t*i);return{x:(e+180)/360*256,y:256*(.5-Math.log((1+n)/(1-n))/r)}}}},function(t,e,i){var r="undefined"!=typeof window?window.L:i(0),n=r.Layer.extend({initialize:function(t,e){this._userDrawFunc=t,this._frame=null,this._redrawCallbacks=[],r.setOptions(this,e)},drawing:function(t){return this._userDrawFunc=t,this},params:function(t){return r.setOptions(this,t),this},redraw:function(t){return"function"==typeof t&&this._redrawCallbacks.push(t),null===this._frame&&(this._frame=r.Util.requestAnimFrame(this._redraw,this)),this},onAdd:function(t){this._map=t,this.canvas=this.canvas||document.createElement("canvas");var e=this._map.getSize(),i=this._map.options.zoomAnimation&&r.Browser.any3d;this.canvas.width=e.x,this.canvas.height=e.y,this.canvas.className="leaflet-zoom-"+(i?"animated":"hide"),t._panes.overlayPane.appendChild(this.canvas),t.on("moveend",this._reset,this),t.on("resize",this._resize,this),t.options.zoomAnimation&&r.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this.canvas),t.off("moveend",this._reset,this),t.off("resize",this._resize,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},_resize:function(t){this.canvas.width=t.newSize.x,this.canvas.height=t.newSize.y},_reset:function(){var t=this._map.containerPointToLayerPoint([0,0]);r.DomUtil.setPosition(this.canvas,t),this._redraw()},_redraw:function(){var t=this._map.getSize(),e=this._map.getBounds(),i=180*t.x/(20037508.34*(e.getEast()-e.getWest())),r=this._map.getZoom();for(this._userDrawFunc&&this._userDrawFunc(this,{canvas:this.canvas,bounds:e,size:t,zoomScale:i,zoom:r,options:this.options});this._redrawCallbacks.length>0;)this._redrawCallbacks.shift()(this);this._frame=null},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=r.Layer?this._map._latLngBoundsToNewLayerBounds(this._map.getBounds(),t.zoom,t.center).min:this._map._getCenterOffset(t.center)._multiplyBy(-e).subtract(this._map._getMapPanePos());r.DomUtil.setTransform(this.canvas,i,e)},setTransform:function(t,e,i){var n=e||new r.Point(0,0);t.style[r.DomUtil.TRANSFORM]=(r.Browser.ie3d?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(i?" scale("+i+")":"")}});canvasOverlay=function(t,e){return new n(t,e)},t.exports={canvasOverlay:canvasOverlay,CanvasOverlay:n}},,,,,function(t,e,i){t.exports=i(10)},function(t,e,i){(function(e){var r=i(15),n=i(16),a=i(1),s={longitudeKey:1,latitudeKey:0,longitudeFirst:function(){return s.longitudeKey=0,s.latitudeKey=1,s},latitudeFirst:function(){return s.latitudeKey=0,s.longitudeKey=1,s},get instances(){return[].concat(r.instances).concat(n.instances)},points:function(t){var e={setupClick:s.setupClick.bind(this),attachShaderVars:s.attachShaderVars.bind(this),latitudeKey:s.latitudeKey,longitudeKey:s.longitudeKey,vertexShaderSource:function(){return s.shader.vertex},fragmentShaderSource:function(){return s.shader.fragment.point},color:s.color.random,closest:s.closest.bind(this)};for(var i in t)e[i]=t[i];return new r(e)},shapes:function(t){var e={setupClick:s.setupClick.bind(this),attachShaderVars:s.attachShaderVars.bind(this),latitudeKey:s.latitudeKey,longitudeKey:s.longitudeKey,vertexShaderSource:function(){return s.shader.vertex},fragmentShaderSource:function(){return s.shader.fragment.polygon},color:s.color.random,closest:s.closest.bind(this)};for(var i in t)e[i]=t[i];return new n(e)},Points:r,Shapes:n,maps:[],setupClick:function(t){this.maps.indexOf(t)<0&&(this.maps.push(t),t.on("click",function(e){var i;return void 0!==(i=r.tryClick(e,t))?i:void 0!==(i=n.tryClick(e,t))?i:void 0}))},pointInCircle:function(t,e,i){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)<=i*i},attachShaderVars:function(t,e,i,r){var n,a,s;for(n in r)if(r.hasOwnProperty(n)){if(s=r[n],(a=e.getAttribLocation(i,n))<0)throw console.log(n,s),new Error("shader variable "+n+" not found");e.vertexAttribPointer(a,s.size,e[s.type],!1,t*(s.bytes||5),t*s.start),e.enableVertexAttribArray(a)}return this},debugPoint:function(t){var e=document.createElement("div"),i=e.style,r=t.x,n=t.y;return i.left=r+"px",i.top=n+"px",i.width="10px",i.height="10px",i.position="absolute",i.backgroundColor="#"+(16777215*Math.random()<<0).toString(16),document.body.appendChild(e),this},closest:function(t,e,i){var r=this;return e.length<1?null:e.reduce(function(e,n){return r.locationDistance(t,e,i)<r.locationDistance(t,n,i)?e:n})},vectorDistance:function(t,e){return Math.sqrt(t*t+e*e)},locationDistance:function(t,e,i){var r=i.latLngToLayerPoint(t),n=i.latLngToLayerPoint(e),a=r.x-n.x,s=r.y-n.y;return this.vectorDistance(a,s)},color:{fromHex:function(t){return t.length<6?null:("#"===(t=t.toLowerCase())[0]&&(t=t.substring(1,t.length)),{r:parseInt(t[0]+t[1],16)/255,g:parseInt(t[2]+t[3],16)/255,b:parseInt(t[4]+t[5],16)/255})},green:{r:0,g:1,b:0},red:{r:1,g:0,b:0},blue:{r:0,g:0,b:1},teal:{r:0,g:1,b:1},yellow:{r:1,g:1,b:0},white:{r:1,g:1,b:1},black:{r:0,g:0,b:0},gray:{r:.5,g:.5,b:.5},get grey(){return s.color.gray},random:function(){return{r:Math.random(),g:Math.random(),b:Math.random()}},pallet:function(){switch(Math.round(4*Math.random())){case 0:return s.color.green;case 1:return s.color.red;case 2:return s.color.blue;case 3:return s.color.teal;case 4:return s.color.yellow}}},mapMatrix:a,shader:{vertex:e("dW5pZm9ybSBtYXQ0IG1hdHJpeDsKYXR0cmlidXRlIHZlYzQgdmVydGV4OwphdHRyaWJ1dGUgZmxvYXQgcG9pbnRTaXplOwphdHRyaWJ1dGUgdmVjNCBjb2xvcjsKdmFyeWluZyB2ZWM0IF9jb2xvcjsKCnZvaWQgbWFpbigpIHsKICAvL3NldCB0aGUgc2l6ZSBvZiB0aGUgcG9pbnQKICBnbF9Qb2ludFNpemUgPSBwb2ludFNpemU7CgogIC8vbXVsdGlwbHkgZWFjaCB2ZXJ0ZXggYnkgYSBtYXRyaXguCiAgZ2xfUG9zaXRpb24gPSBtYXRyaXggKiB2ZXJ0ZXg7CgogIC8vcGFzcyB0aGUgY29sb3IgdG8gdGhlIGZyYWdtZW50IHNoYWRlcgogIF9jb2xvciA9IGNvbG9yOwp9","base64"),fragment:{dot:e("cHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CnVuaWZvcm0gdmVjNCBjb2xvcjsKdW5pZm9ybSBmbG9hdCBvcGFjaXR5OwoKdm9pZCBtYWluKCkgewogICAgZmxvYXQgYm9yZGVyID0gMC4wNTsKICAgIGZsb2F0IHJhZGl1cyA9IDAuNTsKICAgIHZlYzIgY2VudGVyID0gdmVjMigwLjUpOwoKICAgIHZlYzQgY29sb3IwID0gdmVjNCgwLjApOwogICAgdmVjNCBjb2xvcjEgPSB2ZWM0KGNvbG9yWzBdLCBjb2xvclsxXSwgY29sb3JbMl0sIG9wYWNpdHkpOwoKICAgIHZlYzIgbSA9IGdsX1BvaW50Q29vcmQueHkgLSBjZW50ZXI7CiAgICBmbG9hdCBkaXN0ID0gcmFkaXVzIC0gc3FydChtLnggKiBtLnggKyBtLnkgKiBtLnkpOwoKICAgIGZsb2F0IHQgPSAwLjA7CiAgICBpZiAoZGlzdCA+IGJvcmRlcikgewogICAgICAgIHQgPSAxLjA7CiAgICB9IGVsc2UgaWYgKGRpc3QgPiAwLjApIHsKICAgICAgICB0ID0gZGlzdCAvIGJvcmRlcjsKICAgIH0KCiAgICAvL3dvcmtzIGZvciBvdmVybGFwcGluZyBjaXJjbGVzIGlmIGJsZW5kaW5nIGlzIGVuYWJsZWQKICAgIGdsX0ZyYWdDb2xvciA9IG1peChjb2xvcjAsIGNvbG9yMSwgdCk7Cn0=","base64"),point:e("cHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CnZhcnlpbmcgdmVjNCBfY29sb3I7CnVuaWZvcm0gZmxvYXQgb3BhY2l0eTsKCnZvaWQgbWFpbigpIHsKICBmbG9hdCBib3JkZXIgPSAwLjE7CiAgZmxvYXQgcmFkaXVzID0gMC41OwogIHZlYzIgY2VudGVyID0gdmVjMigwLjUsIDAuNSk7CgogIHZlYzQgcG9pbnRDb2xvciA9IHZlYzQoX2NvbG9yWzBdLCBfY29sb3JbMV0sIF9jb2xvclsyXSwgb3BhY2l0eSk7CgogIHZlYzIgbSA9IGdsX1BvaW50Q29vcmQueHkgLSBjZW50ZXI7CiAgZmxvYXQgZGlzdDEgPSByYWRpdXMgLSBzcXJ0KG0ueCAqIG0ueCArIG0ueSAqIG0ueSk7CgogIGZsb2F0IHQxID0gMC4wOwogIGlmIChkaXN0MSA+IGJvcmRlcikgewogICAgICB0MSA9IDEuMDsKICB9IGVsc2UgaWYgKGRpc3QxID4gMC4wKSB7CiAgICAgIHQxID0gZGlzdDEgLyBib3JkZXI7CiAgfQoKICAvL3dvcmtzIGZvciBvdmVybGFwcGluZyBjaXJjbGVzIGlmIGJsZW5kaW5nIGlzIGVuYWJsZWQKICAvL2dsX0ZyYWdDb2xvciA9IG1peChjb2xvcjAsIGNvbG9yMSwgdCk7CgogIC8vYm9yZGVyCiAgZmxvYXQgb3V0ZXJCb3JkZXIgPSAwLjA1OwogIGZsb2F0IGlubmVyQm9yZGVyID0gMC44OwogIHZlYzQgYm9yZGVyQ29sb3IgPSB2ZWM0KDAsIDAsIDAsIDAuNCk7CiAgdmVjMiB1diA9IGdsX1BvaW50Q29vcmQueHk7CiAgdmVjNCBjbGVhckNvbG9yID0gdmVjNCgwLCAwLCAwLCAwKTsKICAKICAvLyBPZmZzZXQgdXYgd2l0aCB0aGUgY2VudGVyIG9mIHRoZSBjaXJjbGUuCiAgdXYgLT0gY2VudGVyOwogIAogIGZsb2F0IGRpc3QyID0gIHNxcnQoZG90KHV2LCB1dikpOwogCiAgZmxvYXQgdDIgPSAxLjAgKyBzbW9vdGhzdGVwKHJhZGl1cywgcmFkaXVzICsgb3V0ZXJCb3JkZXIsIGRpc3QyKQogICAgICAgICAgICAgICAgLSBzbW9vdGhzdGVwKHJhZGl1cyAtIGlubmVyQm9yZGVyLCByYWRpdXMsIGRpc3QyKTsKIAogIGdsX0ZyYWdDb2xvciA9IG1peChtaXgoYm9yZGVyQ29sb3IsIGNsZWFyQ29sb3IsIHQyKSwgcG9pbnRDb2xvciwgdDEpOwp9","base64"),puck:e("cHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CnZhcnlpbmcgdmVjNCBfY29sb3I7CnVuaWZvcm0gZmxvYXQgb3BhY2l0eTsKCnZvaWQgbWFpbigpIHsKICB2ZWMyIGNlbnRlciA9IHZlYzIoMC41KTsKICB2ZWMyIHV2ID0gZ2xfUG9pbnRDb29yZC54eSAtIGNlbnRlcjsKICBmbG9hdCBzbW9vdGhpbmcgPSAwLjAwNTsKICB2ZWM0IF9jb2xvcjEgPSB2ZWM0KF9jb2xvclswXSwgX2NvbG9yWzFdLCBfY29sb3JbMl0sIG9wYWNpdHkpOwogIGZsb2F0IHJhZGl1czEgPSAwLjM7CiAgdmVjNCBfY29sb3IyID0gdmVjNChfY29sb3JbMF0sIF9jb2xvclsxXSwgX2NvbG9yWzJdLCBvcGFjaXR5KTsKICBmbG9hdCByYWRpdXMyID0gMC41OwogIGZsb2F0IGRpc3QgPSBsZW5ndGgodXYpOwoKICAvL1NNT09USAogIGZsb2F0IGdhbW1hID0gMi4yOwogIGNvbG9yMS5yZ2IgPSBwb3coX2NvbG9yMS5yZ2IsIHZlYzMoZ2FtbWEpKTsKICBjb2xvcjIucmdiID0gcG93KF9jb2xvcjIucmdiLCB2ZWMzKGdhbW1hKSk7CgogIHZlYzQgcHVjayA9IG1peCgKICAgIG1peCgKICAgICAgX2NvbG9yMSwKICAgICAgX2NvbG9yMiwKICAgICAgc21vb3Roc3RlcCgKICAgICAgICByYWRpdXMxIC0gc21vb3RoaW5nLAogICAgICAgIHJhZGl1czEgKyBzbW9vdGhpbmcsCiAgICAgICAgZGlzdAogICAgICApCiAgICApLAogICAgdmVjNCgwLDAsMCwwKSwKICAgICAgc21vb3Roc3RlcCgKICAgICAgICByYWRpdXMyIC0gc21vb3RoaW5nLAogICAgICAgIHJhZGl1czIgKyBzbW9vdGhpbmcsCiAgICAgICAgZGlzdAogICAgKQogICk7CgogIC8vR2FtbWEgY29ycmVjdGlvbiAocHJldmVudHMgY29sb3IgZnJpbmdlcykKICBwdWNrLnJnYiA9IHBvdyhwdWNrLnJnYiwgdmVjMygxLjAgLyBnYW1tYSkpOwogIGdsX0ZyYWdDb2xvciA9IHB1Y2s7Cn0=","base64"),simpleCircle:e("cHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CnVuaWZvcm0gZmxvYXQgb3BhY2l0eTsKCnZvaWQgbWFpbigpIHsKCiAgICBmbG9hdCBib3JkZXIgPSAwLjA1OwogICAgZmxvYXQgcmFkaXVzID0gMC41OwogICAgdmVjNCBjb2xvcjAgPSB2ZWM0KDAuMCwgMC4wLCAwLjAsIDAuMCk7CiAgICB2ZWM0IGNvbG9yMSA9IHZlYzQoY29sb3JbMF0sIGNvbG9yWzFdLCBjb2xvclsyXSwgb3BhY2l0eSk7CgogICAgdmVjMiBtID0gZ2xfUG9pbnRDb29yZC54eSAtIHZlYzIoMC41LCAwLjUpOwogICAgZmxvYXQgZGlzdCA9IHJhZGl1cyAtIHNxcnQobS54ICogbS54ICsgbS55ICogbS55KTsKCiAgICBmbG9hdCB0ID0gMC4wOwogICAgaWYgKGRpc3QgPiBib3JkZXIpIHsKICAgICAgICB0ID0gMS4wOwogICAgfSBlbHNlIGlmIChkaXN0ID4gMC4wKSB7CiAgICAgICAgdCA9IGRpc3QgLyBib3JkZXI7CiAgICB9CgogICAgLy9zaW1wbGUgY2lyY2xlcwogICAgZmxvYXQgZCA9IGRpc3RhbmNlIChnbF9Qb2ludENvb3JkLCB2ZWMyKDAuNSwgMC41KSk7CiAgICBpZiAoZCA8IDAuNSApewogICAgICAgIGdsX0ZyYWdDb2xvciA9IGNvbG9yMTsKICAgIH0gZWxzZSB7CiAgICAgICAgZGlzY2FyZDsKICAgIH0KfQ==","base64"),square:e("cHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CnVuaWZvcm0gZmxvYXQgb3BhY2l0eTsKCnZvaWQgbWFpbigpIHsKICAgIGZsb2F0IGJvcmRlciA9IDAuMDU7CiAgICBmbG9hdCByYWRpdXMgPSAwLjU7CiAgICB2ZWM0IGNvbG9yMCA9IHZlYzQoMC4wLCAwLjAsIDAuMCwgMC4wKTsKICAgIHZlYzQgY29sb3IxID0gdmVjNChjb2xvclswXSwgY29sb3JbMV0sIGNvbG9yWzJdLCBvcGFjaXR5KTsKICAgIHZlYzIgbSA9IGdsX1BvaW50Q29vcmQueHkgLSB2ZWMyKDAuNSwgMC41KTsKICAgIGZsb2F0IGRpc3QgPSByYWRpdXMgLSBzcXJ0KG0ueCAqIG0ueCArIG0ueSAqIG0ueSk7CgogICAgZmxvYXQgdCA9IDAuMDsKICAgIGlmIChkaXN0ID4gYm9yZGVyKSB7CiAgICAgICAgdCA9IDEuMDsKICAgIH0gZWxzZSBpZiAoZGlzdCA+IDAuMCkgewogICAgICAgIHQgPSBkaXN0IC8gYm9yZGVyOwogICAgfQoKICAgIC8vc3F1YXJlcwogICAgZ2xfRnJhZ0NvbG9yID0gdmVjNChjb2xvclswXSwgY29sb3JbMV0sIGNvbG9yWzJdLCBvcGFjaXR5KTsKfQ==","base64"),polygon:e("cHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CnVuaWZvcm0gZmxvYXQgb3BhY2l0eTsKdmFyeWluZyB2ZWM0IF9jb2xvcjsKCnZvaWQgbWFpbigpIHsKICBnbF9GcmFnQ29sb3IgPSB2ZWM0KF9jb2xvclswXSwgX2NvbG9yWzFdLCBfY29sb3JbMl0sIG9wYWNpdHkpOwp9","base64")}}};t.exports=s,"undefined"!=typeof window&&window.L&&(window.L.glify=s)}).call(this,i(11).Buffer)},,,,,function(t,e,i){var r=i(3),n="undefined"!=typeof window?window.L:i(0),a=i(1),s=i(4).canvasOverlay,o=function t(e){if(t.instances.push(this),this.settings=r.defaults(e,t.defaults),!e.data)throw new Error('no "data" array setting defined');if(!e.map)throw new Error('no leaflet "map" object setting defined');this.active=!0;var i=this,n=this.glLayer=s(function(){i.drawOnCanvas()}).addTo(e.map),o=this.canvas=n.canvas;o.width=o.clientWidth,o.height=o.clientHeight,o.style.position="absolute",e.className&&(o.className+=" "+e.className),this.gl=o.getContext("webgl")||o.getContext("experimental-webgl"),this.pixelsToWebGLMatrix=new Float32Array(16),this.mapMatrix=a(),this.vertexShader=null,this.fragmentShader=null,this.program=null,this.matrix=null,this.verts=null,this.latLngLookup=null,this.setup().render()};o.defaults={map:null,data:[],longitudeKey:null,latitudeKey:null,closest:null,attachShaderVars:null,setupClick:null,vertexShaderSource:null,fragmentShaderSource:null,eachVertex:null,click:null,color:"random",opacity:.8,size:null,className:"",sensitivity:2,shaderVars:{color:{type:"FLOAT",start:2,size:3}}},o.instances=[],o.prototype={maps:[],setup:function(){var t=this.settings;return t.click&&this.settings.setupClick(t.map),this.setupVertexShader().setupFragmentShader().setupProgram()},render:function(){this.resetVertices();var t=this.gl,e=this.settings,i=this.canvas,r=this.program,n=this.glLayer,a=this.matrix=t.getUniformLocation(r,"matrix"),s=t.getUniformLocation(r,"opacity"),o=t.getAttribLocation(r,"vertex"),g=t.createBuffer(),l=new Float32Array(this.verts),h=l.BYTES_PER_ELEMENT;return t.pointSize=t.getAttribLocation(r,"pointSize"),this.pixelsToWebGLMatrix.set([2/i.width,0,0,0,0,-2/i.height,0,0,0,0,0,0,-1,1,0,1]),t.viewport(0,0,i.width,i.height),t.uniformMatrix4fv(a,!1,this.pixelsToWebGLMatrix),t.uniform1f(s,this.settings.opacity),t.bindBuffer(t.ARRAY_BUFFER,g),t.bufferData(t.ARRAY_BUFFER,l,t.STATIC_DRAW),t.vertexAttribPointer(o,2,t.FLOAT,!1,5*h,0),t.enableVertexAttribArray(o),null!==e.shaderVars&&this.settings.attachShaderVars(h,t,r,e.shaderVars),n.redraw(),this},resetVertices:function(){this.latLngLookup={},this.verts=[];var t,e,i,n,a,s=this.verts,o=this.settings,g=o.data,l=o.color,h=0,c=g.length,u=this.latLngLookup,d=o.latitudeKey,I=o.longitudeKey;if(null===l)throw new Error("color is not properly defined");for("function"==typeof l&&(t=l,l=void 0);h<c;h++)n=u[a=(e=g[h])[d].toFixed(2)+"x"+e[I].toFixed(2)],i=r.latLonToPixel(e[d],e[I]),void 0===n&&(n=u[a]=[]),n.push(e),t&&(l=t(h,e)),s.push(i.x,i.y,l.r,l.g,l.b),null!==o.eachVertex&&o.eachVertex.call(this,e,i,l);return this},setData:function(t){return this.settings.data=t,this},setupVertexShader:function(){var t=this.gl,e=this.settings,i="function"==typeof e.vertexShaderSource?e.vertexShaderSource():e.vertexShaderSource,r=t.createShader(t.VERTEX_SHADER);return t.shaderSource(r,i),t.compileShader(r),this.vertexShader=r,this},setupFragmentShader:function(){var t=this.gl,e=this.settings,i="function"==typeof e.fragmentShaderSource?e.fragmentShaderSource():e.fragmentShaderSource,r=t.createShader(t.FRAGMENT_SHADER);return t.shaderSource(r,i),t.compileShader(r),this.fragmentShader=r,this},setupProgram:function(){var t=this.gl,e=t.createProgram();return t.attachShader(e,this.vertexShader),t.attachShader(e,this.fragmentShader),t.linkProgram(e),t.useProgram(e),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.enable(t.BLEND),this.program=e,this},pointSize:function(){var t=this.settings,e=t.map,i=t.size,r=e.getZoom();return null===i?Math.max(r-4,1):i},drawOnCanvas:function(){if(null==this.gl)return this;var t=this.gl,e=this.canvas,i=this.settings,a=i.map,s=a.getBounds(),o=new n.LatLng(s.getNorth(),s.getWest()),g=r.latLonToPixel(o.lat,o.lng),l=a.getZoom(),h=Math.pow(2,l),c=this.mapMatrix,u=this.pixelsToWebGLMatrix;return u.set([2/e.width,0,0,0,0,-2/e.height,0,0,0,0,0,0,-1,1,0,1]),c.set(u).scaleMatrix(h).translateMatrix(-g.x,-g.y),t.clear(t.COLOR_BUFFER_BIT),t.viewport(0,0,e.width,e.height),t.vertexAttrib1f(t.pointSize,this.pointSize()),t.uniformMatrix4fv(this.matrix,!1,c),t.drawArrays(t.POINTS,0,i.data.length),this},addTo:function(t){return this.glLayer.addTo(t||this.settings.map),this.active=!0,this.render()},lookup:function(t){for(var e,i,r,n,a,s=t.lat-.03,o=t.lat+.03,g=t.lng+.03,l=[];s<=o;s+=.01)for(e=t.lng-.03;e<=g;e+=.01)if(a=s.toFixed(2)+"x"+e.toFixed(2),n=this.latLngLookup[a])for(i=0,r=n.length;i<r;i++)l.push(n[i]);return this.settings.closest(t,0===l.length?this.settings.data.slice(0):l,this.settings.map)},remove:function(){return this.settings.map.removeLayer(this.glLayer),this.active=!1,this}},o.tryClick=function(t,e){var i,a,s,g,l,h,c,u=[],d={};if(o.instances.forEach(function(i){a=i.settings,i.active&&a.map===e&&a.click&&(g=i.lookup(t.latlng),d[g]=i,u.push(g))}),!(u.length<1)&&a&&null!==(h=a.closest(t.latlng,u,e))&&(s=d[h]))return c=n.latLng(h[a.latitudeKey],h[a.longitudeKey]),l=e.latLngToLayerPoint(c),r.pointInCircle(l,t.layerPoint,s.pointSize()*s.settings.sensitivity)?void 0===(i=s.settings.click(t,h,l))||i:void 0},t.exports=o},function(t,e,i){var r="undefined"!=typeof window?window.L:i(0),n=i(5),a=i(6),s=i(3),o=i(1),g=i(4).canvasOverlay,l=function t(e){if(t.instances.push(this),this.settings=s.defaults(e,t.defaults),!e.data)throw new Error('no "data" array setting defined');if(!e.map)throw new Error('no leaflet "map" object setting defined');this.active=!0;var i=this,r=this.glLayer=g(function(){i.drawOnCanvas()}).addTo(e.map),n=this.canvas=r.canvas;n.width=n.clientWidth,n.height=n.clientHeight,n.style.position="absolute",e.className&&(n.className+=" "+e.className),this.gl=n.getContext("webgl")||n.getContext("experimental-webgl"),this.pixelsToWebGLMatrix=new Float32Array(16),this.mapMatrix=o(),this.vertexShader=null,this.fragmentShader=null,this.program=null,this.matrix=null,this.verts=null,this.latLngLookup=null,this.polygonLookup=null,this.setup().render()};l.defaults={map:null,data:[],longitudeKey:null,latitudeKey:null,attachShaderVars:null,setupClick:null,vertexShaderSource:null,fragmentShaderSource:null,click:null,color:"random",className:"",opacity:.5,shaderVars:{color:{type:"FLOAT",start:2,size:3}}},l.instances=[],l.prototype={maps:[],setup:function(){var t=this.settings;return t.click&&t.setupClick(t.map),this.setupVertexShader().setupFragmentShader().setupProgram()},render:function(){this.resetVertices();var t=this.pixelsToWebGLMatrix,e=this.settings,i=this.canvas,r=this.gl,n=this.glLayer,a=(new Date,this.verts),s=(a.length,r.createBuffer()),o=new Float32Array(a),g=o.BYTES_PER_ELEMENT,l=this.program,h=r.getAttribLocation(l,"vertex"),c=r.getUniformLocation(l,"opacity");return r.uniform1f(c,this.settings.opacity),r.bindBuffer(r.ARRAY_BUFFER,s),r.bufferData(r.ARRAY_BUFFER,o,r.STATIC_DRAW),r.vertexAttribPointer(h,2,r.FLOAT,!1,5*g,0),r.enableVertexAttribArray(h),this.matrix=r.getUniformLocation(l,"matrix"),r.aPointSize=r.getAttribLocation(l,"pointSize"),t.set([2/i.width,0,0,0,0,-2/i.height,0,0,0,0,0,0,-1,1,0,1]),r.viewport(0,0,i.width,i.height),r.uniformMatrix4fv(this.matrix,!1,t),null!==e.shaderVars&&e.attachShaderVars(g,r,l,e.shaderVars),n.redraw(),this},resetVertices:function(){this.verts=[],this.polygonLookup=new a;var t,e,i,r,o,g,l,h,c,u,d=this.verts,I=this.polygonLookup,p=this.settings,C=p.data,v=C.features,m=p.color,b=0,A=v.length;if(I.loadFeatureCollection(C),null===m)throw new Error("color is not properly defined");for("function"==typeof m&&(r=m,m=void 0);b<A;b++){for(i=v[b],o=[],r&&(m=r(b,i)),l=s.flattenData(i.geometry.coordinates),g=n(l.vertices,l.holes,l.dimensions),h=i.geometry.coordinates[0][0].length,u=0,c=g.length;u<c;u++)e=g[u],o.push(l.vertices[e*h+p.longitudeKey],l.vertices[e*h+p.latitudeKey]);for(u=0,c=o.length;u<c;u)t=s.latLonToPixel(o[u++],o[u++]),d.push(t.x,t.y,m.r,m.g,m.b)}return this},setupVertexShader:function(){var t=this.gl,e=this.settings,i="function"==typeof e.vertexShaderSource?e.vertexShaderSource():e.vertexShaderSource,r=t.createShader(t.VERTEX_SHADER);return t.shaderSource(r,i),t.compileShader(r),this.vertexShader=r,this},setupFragmentShader:function(){var t=this.gl,e=this.settings,i="function"==typeof e.fragmentShaderSource?e.fragmentShaderSource():e.fragmentShaderSource,r=t.createShader(t.FRAGMENT_SHADER);return t.shaderSource(r,i),t.compileShader(r),this.fragmentShader=r,this},setupProgram:function(){var t=this.gl,e=t.createProgram();return t.attachShader(e,this.vertexShader),t.attachShader(e,this.fragmentShader),t.linkProgram(e),t.useProgram(e),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.enable(t.BLEND),this.program=e,this},drawOnCanvas:function(){if(null==this.gl)return this;var t=this.gl,e=this.settings,i=this.canvas,n=e.map,a=Math.max(n.getZoom()-4,1),o=n.getBounds(),g=new r.LatLng(o.getNorth(),o.getWest()),l=Math.pow(2,n.getZoom()),h=s.latLonToPixel(g.lat,g.lng),c=this.mapMatrix,u=this.pixelsToWebGLMatrix;return u.set([2/i.width,0,0,0,0,-2/i.height,0,0,0,0,0,0,-1,1,0,1]),c.set(u).scaleMatrix(l).translateMatrix(-h.x,-h.y),t.clear(t.COLOR_BUFFER_BIT),t.viewport(0,0,i.width,i.height),t.vertexAttrib1f(t.aPointSize,a),t.uniformMatrix4fv(this.matrix,!1,c),t.drawArrays(t.TRIANGLES,0,this.verts.length/5),this},addTo:function(t){return this.glLayer.addTo(t||this.settings.map),this.active=!0,this.render()},remove:function(){return this.settings.map.removeLayer(this.glLayer),this.active=!1,this}},l.tryClick=function(t,e){var i,r,n;return l.instances.forEach(function(a){r=a.settings,a.active&&r.map===e&&r.click&&void 0!==(n=a.polygonLookup.search(t.latlng.lng,t.latlng.lat))&&(i=r.click(t,n))}),void 0===i||i},t.exports=l}]);